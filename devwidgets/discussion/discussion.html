<!-- CSS -->
<link rel="stylesheet" type="text/css" href="/devwidgets/discussion/css/discussion.css" />

<!-- MAIN VIEW -->
<div id="discussion_main_container" style="display:none">
    <div class="fl-widget-content s3d-widget-content">
        <!-- MAIN CONTAINER FOR BBS -->
        <div id="discussion_container">
            <!-- Show that no initial posts are made -->
            <div id="discussion_no_initial_topic"><!-- --></div>

            <!-- Show the create new topic screen -->
            <div id="discussion_create_new_topic" style="display:none;">
                <form>
                    <div class="s3d-form-field-wrapper">
                        <label for="discussion_create_new_topic_title" class="s3d-bold s3d-input-label s3d-input-label-above">REPLACED</label>
                        <input type="text" id="discussion_create_new_topic_title" name="discussion_topic_title" class="required s3d-input-full-width"/>
                        <label for="discussion_create_new_topic_message_text" class="s3d-bold s3d-input-label s3d-input-label-above">REPLACED</label>
                        <textarea id="discussion_create_new_topic_message_text" class="required s3d-input-full-width" rows="6" name="discussion_topic_text" placeholder="REPLACED"></textarea>
                    </div>
                    <div class="fl-force-right">
                        <button type="button" class="s3d-button s3d-link-button" id="discussion_dont_add_topic">REPLACED</button>
                        <button type="submit" class="s3d-button s3d-overlay-button" id="discussion_add_topic">REPLACED</button>
                        <hr class="fl-push fl-hidden"/>
                    </div>
                </form>
            </div>

            <!-- Show the topics and replies -->
            <div id="discussion_list_topics" style="display:none;">
                <div id="discussion_list_topics_container"><!-- --></div>
            </div>
        </div>
    </div>
    <div class="s3d-widget-no-options">
        <div class="s3d-widget-no-options-inner"></div>
    </div>
</div>

<div id="discussion_no_initial_topic_template"><!--
    {if settings.addtopic == true}
        <button id="discussion_add_new_topic" class="s3d-button s3d-regular-links s3d-link-button">REPLACED</button>
        <div class="fl-force-right discussion_not_changeable" style="display:none">(REPLACED)</div>
        <hr class="discussion_horizontal_rule"/>
        REPLACED
    {else}
        REPLACED
    {/if}
--></div>

<div id="discussion_topic_reply_template"><!--
    <form class="discussion_{if edit === true}edit{else}reply{/if}_form s3d-form-field-wrapper">
        {if quoted}
            <span id="discussion_topic_reply_quoted_user" style="display:none;">${quotedUser}</span>
            <label for="discussion_topic_quoted_text" class="s3d-bold s3d-input-label s3d-input-label-above">
                REPLACED
            </label>
            <textarea id="discussion_topic_quoted_text" class="required s3d-input-full-width" rows="4" name="quoted_text" title="REPLACED">${quotedMessage|safeOutput}</textarea>
        {/if}
        <label for="discussion_topic_reply_text" class="s3d-bold s3d-input-label s3d-input-label-above">
            REPLACED
        </label>
        <textarea id="discussion_topic_reply_text" class="required  s3d-input-full-width" rows="6" name="message_text" placeholder="REPLACED">{if edit == true}${body}{/if}</textarea>
        <div class="fl-force-right">
            {if edit == true}
                <button type="button" class="s3d-button s3d-link-button" id="discussion_dont_save_edit">REPLACED</button>
                <button type="submit" class="s3d-button s3d-overlay-button" id="discussion_save_edit">REPLACED</button>
                <hr class="fl-push fl-hidden"/>
            {else}
                <button type="button" class="s3d-button s3d-link-button" id="discussion_dont_add_reply">REPLACED</button>
                <button type="submit" class="s3d-button s3d-overlay-button" id="discussion_add_reply">REPLACED</button>
                <hr class="fl-push fl-hidden"/>
            {/if}
        </div>
    </form>
--></div>

<div id="discussion_topic_newly_posted_reply_template"><!--
    <div class="s3d-highlight_area_background" id="${post.message["sakai:id"]}">
        <div class="s3d-highlight_area_background_tl">
            <div class="s3d-highlight_area_background_tinner"></div>
        </div>
        <div class="discussion_entity_container">
            {var displayName = sakai.api.User.getDisplayName(post.message.profile)}
            <img src="${post.message.profile.pictureImg}" alt="${displayName}" class="discussion_entity_picture"/>
            <a href="${post.message.profile.homePath}" title="REPLACED" class="discussion_poster_name">${displayName}</a>
            <span class="discussion_posting_date">${post.message["sakai:createdOn"]}<span class="discussion_updating_date" {if !post.message["sakai:editedOn"]}style="display:none;"{/if}>(REPLACED <span></span>)</span></span>
            <hr class="fl-push fl-hidden"/>
        </div>

        <div class="discussion_reply_contents">
            {if post.message["sakai:quoted"]}
                <div class="discussion_quoted_text_container s3d-highlight_area_background">
                    <div class="s3d-highlight_area_background_white_content_tl">
                        <div class="s3d-highlight_area_background_white_content_tinner"></div>
                    </div>
                    <p><span class="discussion_reply_contents_text_quoted">${post.message["sakai:quoted"].by}</span> REPLACED:</p>
                    <p class="discussion_reply_contents_text" data-source-text="${post.message["sakai:quoted"].quote|saneHTMLAttribute}">${post.message["sakai:quoted"].quote|safeOutput}</p>
                    <div class="s3d-highlight_area_background_white_content_bl">
                        <div class="s3d-highlight_area_background_white_content_binner"></div>
                    </div>
                </div>
            {/if}

            <div><span class="discussion_post_message" data-source-text="${post.message["sakai:body"]|saneHTMLAttribute}">${post.message["sakai:body"]|safeOutput}</span></div>

            {if settings.anon != true && settings.canreply == true}
                <span class="discussion_message_options">
                    <button class="discussion_quote s3d-button s3d-regular-links s3d-link-button">REPLACED</button>
                    {if post.message["sakai:from"] == settings.userid || settings.ismanager}
                        <span class="discussion_pipe_divider">|</span>
                        <button class="discussion_edit s3d-button s3d-regular-links s3d-link-button">REPLACED</button>
                    {/if}
                    {if settings.ismanager}
                        <span class="discussion_pipe_divider">|</span>
                        <button class="discussion_delete s3d-button s3d-regular-links s3d-link-button">REPLACED</button>
                    {/if}
                </span>
            {/if}
        </div>

        <div class="discussion_edit_container"></div>

        <div class="s3d-highlight_area_background_bl">
            <div class="s3d-highlight_area_background_binner"></div>
        </div>
    </div>
--></div>

<div id="discussion_list_topics_template"><!--
    {if settings.addtopic == true}
        <button id="discussion_add_new_topic" class="s3d-button s3d-regular-links s3d-link-button">REPLACED</button><span class="discussion_pipe_divider">|</span>
        <div class="fl-force-right discussion_not_changeable" style="display:none">(REPLACED)</div>
    {/if}
    <button id="discussion_expand_all" class="s3d-button s3d-regular-links discussion_expand_all s3d-link-button">REPLACED</button>
    <hr class="discussion_horizontal_rule"/>
    {for topic in postData}
        <div id="discussion_post_${topic.post["sakai:id"]}" class="discussion_topic_container">
            {if settings.anon != true && settings.canreply == true}
                <button type="button" class="s3d-button s3d-overlay-button discussion_reply_topic" id="discussion_reply_topic">REPLACED</button>
            {/if}
            <h1 class="discussion_topic_subject">${topic.post["sakai:subject"]|safeOutput}</h1>
            <button class="discussion_show_topic_replies s3d-button s3d-link-button"><div class="discussion_replies_icon discussion_show_replies_icon"{if topic.replies.length === 0} style="display:none;"{/if}></div><span class="discussion_topic_number_of_replies"><span class="discussion_number_of_replies">${topic.replies.length}</span> REPLACED</span></button>

            <div class="s3d-highlight_area_background" id="${topic.post["sakai:id"]}">
                <div class="s3d-highlight_area_background_tl">
                    <div class="s3d-highlight_area_background_tinner"></div>
                </div>
                <div class="discussion_entity_container">
                    {var displayName = sakai.api.User.getDisplayName(topic.post.profile[0])}
                    <img src="${topic.post.profile[0].pictureImg}" alt="${displayName}" class="discussion_entity_picture"/>
                    <a href="${topic.post.profile[0].homePath}" class="discussion_poster_name" title="REPLACED">${displayName}</a>
                    <span class="discussion_posting_date">${topic.post["sakai:createdOn"]}<span class="discussion_updating_date" {if !topic.post["sakai:editedOn"]}style="display:none;"{/if}>{if topic.post["sakai:editedOn"]} (REPLACED <span>${topic.post["sakai:editedBy"]} ${topic.post["sakai:editedOn"]}</span>) {else} (REPLACED <span></span>){/if}</span></span>
                    <hr class="fl-push fl-hidden"/>
                </div>

                <div class="discussion_reply_contents">
                    <div class="discussion_ellipsis_container">
                        <span class="discussion_post_message discussion_ellipsis_text" data-source-text="${topic.post["sakai:body"]|saneHTMLAttribute}">${topic.post["sakai:body"]|safeOutput}</span>
                    </div>
                    {if settings.anon != true && settings.canreply == true}
                        <span class="discussion_message_options">
                            <button class="discussion_quote s3d-button s3d-regular-links s3d-link-button">REPLACED</button>
                            {if topic.post["sakai:from"] == settings.userid || settings.ismanager == true}
                                <span class="discussion_pipe_divider">|</span>
                                <button class="discussion_edit s3d-button s3d-regular-links s3d-link-button">REPLACED</button>
                            {/if}
                        </span>
                    {/if}
                </div>

                <div class="discussion_edit_container"></div>

                <div class="s3d-highlight_area_background_bl">
                    <div class="s3d-highlight_area_background_binner"></div>
                </div>
            </div>

            <div class="discussion_topic_replies_container" style="display:none;">
                {for reply in topic.replies}
                    <div {if reply.post["sakai:deleted"] && reply.post["sakai:deleted"] == "true"} class="s3d-highlight_area_background discussion_deleted_reply"{else} class="s3d-highlight_area_background"{/if}id="${reply.post["sakai:id"]}">
                        <div class="s3d-highlight_area_background_tl">
                            <div class="s3d-highlight_area_background_tinner"></div>
                        </div>
                        <div class="discussion_entity_container">
                            {if reply.post["sakai:deleted"] && reply.post["sakai:deleted"] == "true"}
                                <button class="discussion_hide_reply s3d-button s3d-regular-links s3d-link-button"><span>REPLACED</span><span style="display:none;">REPLACED</span></button>
                            {/if}
                            {var displayName = sakai.api.User.getDisplayName(reply.post.profile[0])}
                            <img src="${reply.post.profile[0].pictureImg}" alt="${displayName}" class="discussion_entity_picture"/>
                            <a href="${reply.post.profile[0].homePath}" class="discussion_poster_name" title="REPLACED">${displayName}</a>
                            <span class="discussion_posting_date">${reply.post["sakai:createdOn"]}<span class="discussion_updating_date" {if !reply.post["sakai:editedOn"]}style="display:none;"{/if}>{if reply.post["sakai:editedOn"]} (REPLACED <span>${reply.post["sakai:editedBy"]} ${reply.post["sakai:editedOn"]}</span>) {else} (REPLACED <span></span>){/if}</span></span>
                            {if reply.post["sakai:deleted"] && reply.post["sakai:deleted"] == "true"}
                                <span class="discussion_delete_date">(REPLACED ${reply.post["sakai:deletedBy"]} ${reply.post["sakai:deletedOn"]})</span>
                            {/if}
                            <hr class="fl-push fl-hidden"/>
                        </div>

                        <div class="discussion_reply_contents">
                            {if reply.post["sakai:quoted"]}
                                <div class="discussion_quoted_text_container s3d-highlight_area_background">
                                    <div class="s3d-highlight_area_background_white_content_tl">
                                        <div class="s3d-highlight_area_background_white_content_tinner">
                                        </div>
                                    </div>
                                    <p><span class="discussion_reply_contents_text_quoted">${reply.post["sakai:quoted"].by}</span> REPLACED:</p>
                                    <p class="discussion_reply_contents_text" data-source-text="${reply.post["sakai:quoted"].quote|saneHTMLAttribute}">${reply.post["sakai:quoted"].quote|safeOutput}</p>
                                    <div class="s3d-highlight_area_background_white_content_bl">
                                        <div class="s3d-highlight_area_background_white_content_binner">
                                        </div>
                                    </div>
                                </div>
                            {/if}

                            <div><span class="discussion_post_message" data-source-text="${reply.post["sakai:body"]|saneHTMLAttribute}">${reply.post["sakai:body"]|safeOutput}</span></div>

                            {if reply.post["sakai:deleted"] && reply.post["sakai:deleted"] == "true"}
                                <span class="discussion_deleted_message">
                                    {if settings.ismanager}
                                        <p class="discussion_deleted_reply_info">REPLACED</p>
                                        <button class="discussion_restore s3d-button s3d-regular-links s3d-link-button">REPLACED</button>
                                    {elseif reply.post["sakai:from"] == settings.userid}
                                        <p class="discussion_deleted_reply_info">REPLACED REPLACED</p>
                                    {else}
                                        <p class="discussion_deleted_reply_info">REPLACED</p>
                                    {/if}
                                </span>
                            {else}
                                {if settings.anon != true && settings.canreply == true}
                                    <span class="discussion_message_options">
                                        <button class="discussion_quote s3d-button s3d-regular-links s3d-link-button">REPLACED</button>
                                        {if reply.post["sakai:from"] == settings.userid || settings.ismanager}
                                            <span class="discussion_pipe_divider">|</span>
                                            <button class="discussion_edit s3d-button s3d-regular-links s3d-link-button">REPLACED</button>
                                        {/if}
                                        {if settings.ismanager}
                                            <span class="discussion_pipe_divider">|</span>
                                            <button class="discussion_delete s3d-button s3d-regular-links s3d-link-button">REPLACED</button>
                                        {/if}
                                    </span>
                                {/if}
                            {/if}
                        </div>

                        <div class="discussion_edit_container"></div>

                        <div class="s3d-highlight_area_background_bl">
                            <div class="s3d-highlight_area_background_binner"></div>
                        </div>
                    </div>
                {/for}
            </div>
            <div id="discussion_topic_reply_container" style="display:none;"></div>
            {if settings.anon != true && settings.canreply == true}
                <button type="button" class="s3d-button s3d-overlay-button discussion_reply_topic discussion_reply_topic_bottom" id="discussion_reply_topic" style="display:none;">
                    REPLACED
                </button>
            {/if}
            <hr class="discussion_horizontal_rule fl-push"/>
        </div>
    {/for}
--></div>

<div id="discussion_restored_post_actions_template"><!--
    <button class="discussion_quote s3d-button s3d-regular-links s3d-link-button">REPLACED</button>
    <span class="discussion_pipe_divider">|</span>
    <button class="discussion_edit s3d-button s3d-regular-links s3d-link-button">REPLACED</button>
    <span class="discussion_pipe_divider">|</span>
    <button class="discussion_delete s3d-button s3d-regular-links s3d-link-button">REPLACED</button>
--></div>

<div id="discussion_deleted_post_entity_info_template" style="display:none;"><!--
    <span class="discussion_delete_date">(REPLACED ${deletedBy} ${deletedOn})</span>
--></div>

<div id="discussion_deleted_post_actions_template" style="display:none;"><!--
    <p class="discussion_deleted_reply_info">REPLACED</p>
    <button class="discussion_restore s3d-button s3d-regular-links s3d-link-button">REPLACED</button>
--></div>

<!-- SETTINGS VIEW -->
<div id="discussion_settings" style="display:none">
    <div class="s3d-widget-content">
        <div id="discussion_tab_content">
            <div id="discussion_tab_content_settings_container">
                <!-- -->
            </div>
            <div class="fl-force-right">
                <button type="button" class="s3d-button s3d-link-button" id="discussion_settings_cancel">REPLACED</button>
                <button type="button" class="s3d-button s3d-overlay-action-button" id="discussion_settings_submit">REPLACED</button>
                <hr class="fl-push fl-hidden"/>
            </div>
        </div>
    </div>
</div>

<div id="discussion_tab_content_settings_template"><!--
    <h1>REPLACED</h1>
    <div id="discussion_settings_permissions_container" class="discussion_settings_container">
        <span>REPLACED:</span>
        <ul id="discussion_settings_permissions_add_new">
            <li>
                <input type="radio" id="discussion_settings_permissions_add_new_managers_only" name="discussion_settings_permissions_add_new" value="managers_only" {if settings["whocanaddtopic"] === "managers_only"}checked{/if}/>
                <label for="discussion_settings_permissions_add_new_managers_only">
                    REPLACED
                </label>
            </li>
            <li>
                <input type="radio" id="discussion_settings_permissions_add_new_anyone" name="discussion_settings_permissions_add_new" value="anyone" {if settings["whocanaddtopic"] === "anyone" || settings["whocanaddtopic"] === undefined}checked{/if}/>
                <label for="discussion_settings_permissions_add_new_anyone">
                    REPLACED
                </label>
            </li>
        </ul>
        <span>REPLACED:</span>
        <ul id="discussion_settings_permissions_who_can_reply">
            <li>
                <input type="radio" id="discussion_settings_permissions_who_can_reply_managers_and_members" name="discussion_settings_permissions_who_can_reply" value="managers_and_members" {if settings["whocanreply"] === "managers_and_members"}checked{/if}/>
                <label for="discussion_settings_permissions_who_can_reply_managers_and_members">
                    REPLACED
                </label>
            </li>
            <li>
                <input type="radio" id="discussion_settings_permissions_who_can_reply_anyone" name="discussion_settings_permissions_who_can_reply" value="anyone" {if settings["whocanreply"] === "anyone" || settings["whocanreply"] === undefined}checked{/if}/>
                <label for="discussion_settings_permissions_who_can_reply_anyone">
                    REPLACED
                </label>
            </li>
        </ul>
    </div>
--></div>

<div id="discussion_i18n_expand_all" style="display:none;">REPLACED</div>
<div id="discussion_i18n_collapse_all" style="display:none;">REPLACED</div>
<div id="discussion_i18n_hide" style="display:none;">REPLACED</div>
<div id="discussion_i18n_show" style="display:none;">REPLACED</div>

<!-- JAVASCRIPT -->
<script type="text/javascript" src="/devwidgets/discussion/javascript/discussion.js"></script>